# 🎵 AutoChord 数据集说明

## 📊 数据集概览

本项目使用 `generate_single_chords.py` 脚本自动生成和弦MIDI数据，涵盖多种根音、和弦类型和配器方案。

### 基本统计

| 项目 | 数量 | 说明 |
|------|------|------|
| **根音** | 7 | C, D, E, F, G, A, B |
| **和弦类型** | 11 | major, minor, dim, aug, sus2, sus4, maj7, min7, dom7, dim7, hdim7 |
| **配器方案** | 8 | satb, sat, atb, sa, piano, piano_bass, strings, full |
| **基础组合** | 616 | 7 × 11 × 8 |
| **重复次数** | 10 | 每个组合10个变体 |
| **总样本数** | 6160 | 616 × 10 |

## 🎼 和弦类型详解

### 三和弦（Triads）
| 和弦 | 音程结构 | 示例 | 说明 |
|------|---------|------|------|
| **major** | 0-4-7 | C-E-G | 大三和弦 |
| **minor** | 0-3-7 | C-Eb-G | 小三和弦 |
| **dim** | 0-3-6 | C-Eb-Gb | 减三和弦 |
| **aug** | 0-4-8 | C-E-G# | 增三和弦 |
| **sus2** | 0-2-7 | C-D-G | 挂二和弦 |
| **sus4** | 0-5-7 | C-F-G | 挂四和弦 |

### 七和弦（Seventh Chords）
| 和弦 | 音程结构 | 示例 | 说明 |
|------|---------|------|------|
| **maj7** | 0-4-7-11 | C-E-G-B | 大七和弦 |
| **min7** | 0-3-7-10 | C-Eb-G-Bb | 小七和弦 |
| **dom7** | 0-4-7-10 | C-E-G-Bb | 属七和弦 |
| **dim7** | 0-3-6-9 | C-Eb-Gb-A | 减七和弦 |
| **hdim7** | 0-3-6-10 | C-Eb-Gb-Bb | 半减七和弦 |

## 🎹 配器方案详解

### 声部配置

| 声部 | 音域范围 | MIDI音高 | 说明 |
|------|---------|---------|------|
| **Soprano** | C4-G5 | 60-79 | 女高音 |
| **Alto** | G3-D5 | 55-74 | 女中音 |
| **Tenor** | C3-G4 | 48-67 | 男高音 |
| **Bass** | E2-C4 | 40-60 | 男低音 |
| **Piano_RH** | C4-C6 | 60-84 | 钢琴右手 |
| **Piano_LH** | C2-C4 | 36-60 | 钢琴左手 |
| **Strings** | C2-C6 | 36-84 | 弦乐 |
| **Pad** | C2-C5 | 36-72 | 合成器垫音 |

### 配器组合

| 配器方案 | 声部数 | 声部组合 | 适用场景 |
|---------|-------|---------|---------|
| **satb** | 4 | S + A + T + B | 四部合唱（最常见） |
| **sat** | 3 | S + A + T | 三部合唱（无低音） |
| **atb** | 3 | A + T + B | 三部合唱（无高音） |
| **sa** | 2 | S + A | 二部合唱 |
| **piano** | 2 | Piano_RH + Piano_LH | 钢琴独奏 |
| **piano_bass** | 3 | Piano_RH + Piano_LH + Bass | 钢琴三重奏 |
| **strings** | 2 | Strings + Bass | 弦乐组 |
| **full** | 5 | S + A + T + B + Strings | 完整编制 |

## 🎨 音乐性变化机制

### 1. 智能音符省略
根据和弦结构和声部数量，智能省略不重要的音符：
- **三和弦**：优先级 根音 > 五音 > 三音
- **七和弦**：优先级 根音 > 三音 > 七音 > 五音

### 2. 音符加倍
- 根音和五音有30%概率被加倍
- 优先在同一声部内加倍（高八度或低八度）

### 3. 八度调整
自动调整音符到各声部的合适音域：
- 确保每个音符在声部音域范围内
- 保持声部之间的合理距离

### 4. 声部对调
每个重复（rep > 0）有一定概率应用声部对调：
- **S-A对调**：30%概率
- **T-B对调**：30%概率
- **A-T对调**：20%概率
- **完全重排**：15%概率（4声部以上）

### 5. 表现力细节
- 随机力度：75-100（MIDI velocity）
- 音符微错位：最多10 ticks（模拟人类演奏）
- 音符长度变化：略微缩短非主音符

## 📁 文件结构

### MIDI生成目录
```
single_chords/
  ├── C_major_satb_01/
  │   ├── Soprano.mid
  │   ├── Alto.mid
  │   ├── Tenor.mid
  │   └── Bass.mid
  ├── C_major_satb_02/    # 第2次重复，不同排列
  ├── C_minor_piano_01/
  │   ├── Piano_RH.mid
  │   └── Piano_LH.mid
  └── ...
```

### WAV渲染目录
```
single_chords_output/
  ├── C_major_satb_01.wav
  ├── C_major_satb_02.wav
  ├── C_minor_piano_01.wav
  └── ...
```

### 文件命名规则
格式：`{根音}_{和弦类型}_{配器方案}_{序号}`

示例：
- `C_major_satb_01` - C大三和弦，SATB配置，第1次重复
- `G_dom7_piano_05` - G属七和弦，钢琴配置，第5次重复
- `A_min7_full_10` - A小七和弦，完整编制，第10次重复

## 🎯 训练数据分布

### 按任务类型

#### Root识别（7类）
- 每个根音：880个样本（11和弦 × 8配器 × 10重复）
- 总计：6160个样本
- 训练集：4928个（80%）
- 验证集：1232个（20%）

#### Chord类型识别（11类）
- 每种和弦类型：560个样本（7根音 × 8配器 × 10重复）
- 总计：6160个样本
- 训练集：4928个（80%）
- 验证集：1232个（20%）

#### Full和弦识别（77类）
- 每个完整和弦：80个样本（8配器 × 10重复）
- 总计：6160个样本
- 训练集：4928个（80%）
- 验证集：1232个（20%）

## 🔧 生成命令

### 基础生成（推荐用于开发测试）
```bash
python generate_single_chords.py -r 2 -o single_chords
```
生成：616 × 2 = 1232个文件夹

### 完整生成（推荐用于训练）
```bash
python generate_single_chords.py -r 10 -o single_chords
```
生成：616 × 10 = 6160个文件夹

### 大规模生成（用于数据增强）
```bash
python generate_single_chords.py -r 20 -o single_chords
```
生成：616 × 20 = 12320个文件夹

## 📈 数据质量保证

### 音乐理论正确性
✅ 所有和弦符合标准音乐理论
✅ 声部进行遵循基本规则
✅ 音域分配合理

### 多样性保证
✅ 10次重复带来不同的声部排列
✅ 8种配器方案覆盖多种音色组合
✅ 随机变化增加表现力多样性

### 数据平衡
✅ 每个类别样本数量相等
✅ 不同配器方案均匀分布
✅ 避免数据偏差

## 🎓 使用建议

### 训练策略
1. **分阶段训练**：先Root → 再Chord → 最后Full
2. **数据增强**：增加重复次数（-r 参数）
3. **配器平衡**：确保各配器方案均衡

### 评估指标
- **Root识别**：目标准确率 85-95%
- **Chord类型**：目标准确率 60-75%
- **Full和弦**：目标准确率 60-70%

### 潜在改进
- [ ] 添加更多和弦类型（6和弦、9和弦等）
- [ ] 支持转位和弦
- [ ] 增加更多配器方案
- [ ] 添加节奏变化
- [ ] 支持和弦进行序列

---

**生成脚本**：`generate_single_chords.py`  
**渲染脚本**：`midi_render.lua`（Reaper）  
**最后更新**：2025-11-02
